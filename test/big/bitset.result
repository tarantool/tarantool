dofile('utils.lua')
---
...
dofile('bitset.lua')
---
...
------------------------------------------------------------------------------
-- BitsetIndex: insert/delete
------------------------------------------------------------------------------
---
...
test_insert_delete(128)
---
sorted output
$       1$
...
------------------------------------------------------------------------------
-- BitsetIndex: ALL
------------------------------------------------------------------------------
---
...
clear()
---
...
fill(1, 128)
---
...
dump(box.index.BITS_ALL)
---
sorted output
$       1$
$       2$
$       3$
$       4$
$       5$
$       6$
$       7$
$       8$
$       9$
$      10$
$      11$
$      12$
$      13$
$      14$
$      15$
$      16$
$      17$
$      18$
$      19$
$      20$
$      21$
$      22$
$      23$
$      24$
$      25$
$      26$
$      27$
$      28$
$      29$
$      30$
$      31$
$      32$
$      33$
$      34$
$      35$
$      36$
$      37$
$      38$
$      39$
$      40$
$      41$
$      42$
$      43$
$      44$
$      45$
$      46$
$      47$
$      48$
$      49$
$      50$
$      51$
$      52$
$      53$
$      54$
$      55$
$      56$
$      57$
$      58$
$      59$
$      60$
$      61$
$      62$
$      63$
$      64$
$      65$
$      66$
$      67$
$      68$
$      69$
$      70$
$      71$
$      72$
$      73$
$      74$
$      75$
$      76$
$      77$
$      78$
$      79$
$      80$
$      81$
$      82$
$      83$
$      84$
$      85$
$      86$
$      87$
$      88$
$      89$
$      90$
$      91$
$      92$
$      93$
$      94$
$      95$
$      96$
$      97$
$      98$
$      99$
$     100$
$     101$
$     102$
$     103$
$     104$
$     105$
$     106$
$     107$
$     108$
$     109$
$     110$
$     111$
$     112$
$     113$
$     114$
$     115$
$     116$
$     117$
$     118$
$     119$
$     120$
$     121$
$     122$
$     123$
$     124$
$     125$
$     126$
$     127$
$     128$
...
------------------------------------------------------------------------------
-- BitsetIndex: BITS_ALL_SET (single bit)
------------------------------------------------------------------------------
---
...
dump(box.index.BITS_ALL_SET, 0)
---
sorted output
...
dump(box.index.BITS_ALL_SET, 1)
---
sorted output
$       1$
$       3$
$       5$
$       7$
$       9$
$      11$
$      13$
$      15$
$      17$
$      19$
$      21$
$      23$
$      25$
$      27$
$      29$
$      31$
$      33$
$      35$
$      37$
$      39$
$      41$
$      43$
$      45$
$      47$
$      49$
$      51$
$      53$
$      55$
$      57$
$      59$
$      61$
$      63$
$      65$
$      67$
$      69$
$      71$
$      73$
$      75$
$      77$
$      79$
$      81$
$      83$
$      85$
$      87$
$      89$
$      91$
$      93$
$      95$
$      97$
$      99$
$     101$
$     103$
$     105$
$     107$
$     109$
$     111$
$     113$
$     115$
$     117$
$     119$
$     121$
$     123$
$     125$
$     127$
...
dump(box.index.BITS_ALL_SET, 2)
---
sorted output
$       2$
$       3$
$       6$
$       7$
$      10$
$      11$
$      14$
$      15$
$      18$
$      19$
$      22$
$      23$
$      26$
$      27$
$      30$
$      31$
$      34$
$      35$
$      38$
$      39$
$      42$
$      43$
$      46$
$      47$
$      50$
$      51$
$      54$
$      55$
$      58$
$      59$
$      62$
$      63$
$      66$
$      67$
$      70$
$      71$
$      74$
$      75$
$      78$
$      79$
$      82$
$      83$
$      86$
$      87$
$      90$
$      91$
$      94$
$      95$
$      98$
$      99$
$     102$
$     103$
$     106$
$     107$
$     110$
$     111$
$     114$
$     115$
$     118$
$     119$
$     122$
$     123$
$     126$
$     127$
...
dump(box.index.BITS_ALL_SET, 8)
---
sorted output
$       8$
$       9$
$      10$
$      11$
$      12$
$      13$
$      14$
$      15$
$      24$
$      25$
$      26$
$      27$
$      28$
$      29$
$      30$
$      31$
$      40$
$      41$
$      42$
$      43$
$      44$
$      45$
$      46$
$      47$
$      56$
$      57$
$      58$
$      59$
$      60$
$      61$
$      62$
$      63$
$      72$
$      73$
$      74$
$      75$
$      76$
$      77$
$      78$
$      79$
$      88$
$      89$
$      90$
$      91$
$      92$
$      93$
$      94$
$      95$
$     104$
$     105$
$     106$
$     107$
$     108$
$     109$
$     110$
$     111$
$     120$
$     121$
$     122$
$     123$
$     124$
$     125$
$     126$
$     127$
...
dump(box.index.BITS_ALL_SET, 1073741824)
---
sorted output
...
dump(box.index.BITS_ALL_SET, 2147483648)
---
sorted output
...
dump(box.index.BITS_ALL_SET, 4294967296)
---
error: 'Supplied key field type does not match index type: expected u32'
...
------------------------------------------------------------------------------
-- BitsetIndex: BITS_ALL_SET (multiple bit)
------------------------------------------------------------------------------
---
...
dump(box.index.BITS_ALL_SET, 3)
---
sorted output
$       3$
$       7$
$      11$
$      15$
$      19$
$      23$
$      27$
$      31$
$      35$
$      39$
$      43$
$      47$
$      51$
$      55$
$      59$
$      63$
$      67$
$      71$
$      75$
$      79$
$      83$
$      87$
$      91$
$      95$
$      99$
$     103$
$     107$
$     111$
$     115$
$     119$
$     123$
$     127$
...
dump(box.index.BITS_ALL_SET, 7)
---
sorted output
$       7$
$      15$
$      23$
$      31$
$      39$
$      47$
$      55$
$      63$
$      71$
$      79$
$      87$
$      95$
$     103$
$     111$
$     119$
$     127$
...
dump(box.index.BITS_ALL_SET, 31)
---
sorted output
$      31$
$      63$
$      95$
$     127$
...
dump(box.index.BITS_ALL_SET, 5)
---
sorted output
$       5$
$       7$
$      13$
$      15$
$      21$
$      23$
$      29$
$      31$
$      37$
$      39$
$      45$
$      47$
$      53$
$      55$
$      61$
$      63$
$      69$
$      71$
$      77$
$      79$
$      85$
$      87$
$      93$
$      95$
$     101$
$     103$
$     109$
$     111$
$     117$
$     119$
$     125$
$     127$
...
dump(box.index.BITS_ALL_SET, 10)
---
sorted output
$      10$
$      11$
$      14$
$      15$
$      26$
$      27$
$      30$
$      31$
$      42$
$      43$
$      46$
$      47$
$      58$
$      59$
$      62$
$      63$
$      74$
$      75$
$      78$
$      79$
$      90$
$      91$
$      94$
$      95$
$     106$
$     107$
$     110$
$     111$
$     122$
$     123$
$     126$
$     127$
...
dump(box.index.BITS_ALL_SET, 27)
---
sorted output
$      27$
$      31$
$      59$
$      63$
$      91$
$      95$
$     123$
$     127$
...
dump(box.index.BITS_ALL_SET, 341)
---
sorted output
...
dump(box.index.BITS_ALL_SET, 2147483649)
---
sorted output
...
dump(box.index.BITS_ALL_SET, 4294967295)
---
sorted output
...
------------------------------------------------------------------------------
-- BitsetIndex: BITS_ALL_NOT_SET (single bit)
------------------------------------------------------------------------------
---
...
dump(box.index.BITS_ALL_NOT_SET, 0)
---
sorted output
$       1$
$       2$
$       3$
$       4$
$       5$
$       6$
$       7$
$       8$
$       9$
$      10$
$      11$
$      12$
$      13$
$      14$
$      15$
$      16$
$      17$
$      18$
$      19$
$      20$
$      21$
$      22$
$      23$
$      24$
$      25$
$      26$
$      27$
$      28$
$      29$
$      30$
$      31$
$      32$
$      33$
$      34$
$      35$
$      36$
$      37$
$      38$
$      39$
$      40$
$      41$
$      42$
$      43$
$      44$
$      45$
$      46$
$      47$
$      48$
$      49$
$      50$
$      51$
$      52$
$      53$
$      54$
$      55$
$      56$
$      57$
$      58$
$      59$
$      60$
$      61$
$      62$
$      63$
$      64$
$      65$
$      66$
$      67$
$      68$
$      69$
$      70$
$      71$
$      72$
$      73$
$      74$
$      75$
$      76$
$      77$
$      78$
$      79$
$      80$
$      81$
$      82$
$      83$
$      84$
$      85$
$      86$
$      87$
$      88$
$      89$
$      90$
$      91$
$      92$
$      93$
$      94$
$      95$
$      96$
$      97$
$      98$
$      99$
$     100$
$     101$
$     102$
$     103$
$     104$
$     105$
$     106$
$     107$
$     108$
$     109$
$     110$
$     111$
$     112$
$     113$
$     114$
$     115$
$     116$
$     117$
$     118$
$     119$
$     120$
$     121$
$     122$
$     123$
$     124$
$     125$
$     126$
$     127$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 2)
---
sorted output
$       1$
$       4$
$       5$
$       8$
$       9$
$      12$
$      13$
$      16$
$      17$
$      20$
$      21$
$      24$
$      25$
$      28$
$      29$
$      32$
$      33$
$      36$
$      37$
$      40$
$      41$
$      44$
$      45$
$      48$
$      49$
$      52$
$      53$
$      56$
$      57$
$      60$
$      61$
$      64$
$      65$
$      68$
$      69$
$      72$
$      73$
$      76$
$      77$
$      80$
$      81$
$      84$
$      85$
$      88$
$      89$
$      92$
$      93$
$      96$
$      97$
$     100$
$     101$
$     104$
$     105$
$     108$
$     109$
$     112$
$     113$
$     116$
$     117$
$     120$
$     121$
$     124$
$     125$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 8)
---
sorted output
$       1$
$       2$
$       3$
$       4$
$       5$
$       6$
$       7$
$      16$
$      17$
$      18$
$      19$
$      20$
$      21$
$      22$
$      23$
$      32$
$      33$
$      34$
$      35$
$      36$
$      37$
$      38$
$      39$
$      48$
$      49$
$      50$
$      51$
$      52$
$      53$
$      54$
$      55$
$      64$
$      65$
$      66$
$      67$
$      68$
$      69$
$      70$
$      71$
$      80$
$      81$
$      82$
$      83$
$      84$
$      85$
$      86$
$      87$
$      96$
$      97$
$      98$
$      99$
$     100$
$     101$
$     102$
$     103$
$     112$
$     113$
$     114$
$     115$
$     116$
$     117$
$     118$
$     119$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 4294967296)
---
error: 'Supplied key field type does not match index type: expected u32'
...
------------------------------------------------------------------------------
-- BitsetIndex: BITS_ALL_NOT_SET (multiple bit)
------------------------------------------------------------------------------
---
...
dump(box.index.BITS_ALL_NOT_SET, 3)
---
sorted output
$       4$
$       8$
$      12$
$      16$
$      20$
$      24$
$      28$
$      32$
$      36$
$      40$
$      44$
$      48$
$      52$
$      56$
$      60$
$      64$
$      68$
$      72$
$      76$
$      80$
$      84$
$      88$
$      92$
$      96$
$     100$
$     104$
$     108$
$     112$
$     116$
$     120$
$     124$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 7)
---
sorted output
$       8$
$      16$
$      24$
$      32$
$      40$
$      48$
$      56$
$      64$
$      72$
$      80$
$      88$
$      96$
$     104$
$     112$
$     120$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 10)
---
sorted output
$       1$
$       4$
$       5$
$      16$
$      17$
$      20$
$      21$
$      32$
$      33$
$      36$
$      37$
$      48$
$      49$
$      52$
$      53$
$      64$
$      65$
$      68$
$      69$
$      80$
$      81$
$      84$
$      85$
$      96$
$      97$
$     100$
$     101$
$     112$
$     113$
$     116$
$     117$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 27)
---
sorted output
$       4$
$      32$
$      36$
$      64$
$      68$
$      96$
$     100$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 85)
---
sorted output
$       2$
$       8$
$      10$
$      32$
$      34$
$      40$
$      42$
$     128$
...
dump(box.index.BITS_ALL_NOT_SET, 4294967295)
---
sorted output
...
------------------------------------------------------------------------------
-- BitsetIndex: BITS_ANY_SET (single bit)
------------------------------------------------------------------------------
---
...
dump(box.index.BITS_ANY_SET, 0)
---
sorted output
...
dump(box.index.BITS_ANY_SET, 16)
---
sorted output
$      16$
$      17$
$      18$
$      19$
$      20$
$      21$
$      22$
$      23$
$      24$
$      25$
$      26$
$      27$
$      28$
$      29$
$      30$
$      31$
$      48$
$      49$
$      50$
$      51$
$      52$
$      53$
$      54$
$      55$
$      56$
$      57$
$      58$
$      59$
$      60$
$      61$
$      62$
$      63$
$      80$
$      81$
$      82$
$      83$
$      84$
$      85$
$      86$
$      87$
$      88$
$      89$
$      90$
$      91$
$      92$
$      93$
$      94$
$      95$
$     112$
$     113$
$     114$
$     115$
$     116$
$     117$
$     118$
$     119$
$     120$
$     121$
$     122$
$     123$
$     124$
$     125$
$     126$
$     127$
...
dump(box.index.BITS_ANY_SET, 128)
---
sorted output
$     128$
...
dump(box.index.BITS_ANY_SET, 4294967296)
---
error: 'Supplied key field type does not match index type: expected u32'
...
------------------------------------------------------------------------------
-- BitsetIndex: BITS_ANY_SET (multiple bit)
------------------------------------------------------------------------------
---
...
dump(box.index.BITS_ANY_SET, 7)
---
sorted output
$       1$
$       2$
$       3$
$       4$
$       5$
$       6$
$       7$
$       9$
$      10$
$      11$
$      12$
$      13$
$      14$
$      15$
$      17$
$      18$
$      19$
$      20$
$      21$
$      22$
$      23$
$      25$
$      26$
$      27$
$      28$
$      29$
$      30$
$      31$
$      33$
$      34$
$      35$
$      36$
$      37$
$      38$
$      39$
$      41$
$      42$
$      43$
$      44$
$      45$
$      46$
$      47$
$      49$
$      50$
$      51$
$      52$
$      53$
$      54$
$      55$
$      57$
$      58$
$      59$
$      60$
$      61$
$      62$
$      63$
$      65$
$      66$
$      67$
$      68$
$      69$
$      70$
$      71$
$      73$
$      74$
$      75$
$      76$
$      77$
$      78$
$      79$
$      81$
$      82$
$      83$
$      84$
$      85$
$      86$
$      87$
$      89$
$      90$
$      91$
$      92$
$      93$
$      94$
$      95$
$      97$
$      98$
$      99$
$     100$
$     101$
$     102$
$     103$
$     105$
$     106$
$     107$
$     108$
$     109$
$     110$
$     111$
$     113$
$     114$
$     115$
$     116$
$     117$
$     118$
$     119$
$     121$
$     122$
$     123$
$     124$
$     125$
$     126$
$     127$
...
dump(box.index.BITS_ANY_SET, 84)
---
sorted output
$       4$
$       5$
$       6$
$       7$
$      12$
$      13$
$      14$
$      15$
$      16$
$      17$
$      18$
$      19$
$      20$
$      21$
$      22$
$      23$
$      24$
$      25$
$      26$
$      27$
$      28$
$      29$
$      30$
$      31$
$      36$
$      37$
$      38$
$      39$
$      44$
$      45$
$      46$
$      47$
$      48$
$      49$
$      50$
$      51$
$      52$
$      53$
$      54$
$      55$
$      56$
$      57$
$      58$
$      59$
$      60$
$      61$
$      62$
$      63$
$      64$
$      65$
$      66$
$      67$
$      68$
$      69$
$      70$
$      71$
$      72$
$      73$
$      74$
$      75$
$      76$
$      77$
$      78$
$      79$
$      80$
$      81$
$      82$
$      83$
$      84$
$      85$
$      86$
$      87$
$      88$
$      89$
$      90$
$      91$
$      92$
$      93$
$      94$
$      95$
$      96$
$      97$
$      98$
$      99$
$     100$
$     101$
$     102$
$     103$
$     104$
$     105$
$     106$
$     107$
$     108$
$     109$
$     110$
$     111$
$     112$
$     113$
$     114$
$     115$
$     116$
$     117$
$     118$
$     119$
$     120$
$     121$
$     122$
$     123$
$     124$
$     125$
$     126$
$     127$
...
dump(box.index.BITS_ANY_SET, 113)
---
sorted output
$       1$
$       3$
$       5$
$       7$
$       9$
$      11$
$      13$
$      15$
$      16$
$      17$
$      18$
$      19$
$      20$
$      21$
$      22$
$      23$
$      24$
$      25$
$      26$
$      27$
$      28$
$      29$
$      30$
$      31$
$      32$
$      33$
$      34$
$      35$
$      36$
$      37$
$      38$
$      39$
$      40$
$      41$
$      42$
$      43$
$      44$
$      45$
$      46$
$      47$
$      48$
$      49$
$      50$
$      51$
$      52$
$      53$
$      54$
$      55$
$      56$
$      57$
$      58$
$      59$
$      60$
$      61$
$      62$
$      63$
$      64$
$      65$
$      66$
$      67$
$      68$
$      69$
$      70$
$      71$
$      72$
$      73$
$      74$
$      75$
$      76$
$      77$
$      78$
$      79$
$      80$
$      81$
$      82$
$      83$
$      84$
$      85$
$      86$
$      87$
$      88$
$      89$
$      90$
$      91$
$      92$
$      93$
$      94$
$      95$
$      96$
$      97$
$      98$
$      99$
$     100$
$     101$
$     102$
$     103$
$     104$
$     105$
$     106$
$     107$
$     108$
$     109$
$     110$
$     111$
$     112$
$     113$
$     114$
$     115$
$     116$
$     117$
$     118$
$     119$
$     120$
$     121$
$     122$
$     123$
$     124$
$     125$
$     126$
$     127$
...
-- vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4 syntax=lua 

---
...
