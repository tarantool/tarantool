# set foo (and should get it) 
set foo 0 0 6
fooval
STORED
get foo
VALUE foo 0 6
fooval
END
# add bar (and should get it)
set bar 0 0 6
barval
STORED
get bar
VALUE bar 0 6
barval
END
# add foo (but shouldn't get new value)
add foo 0 0 5
foov2
NOT_STORED
get foo
VALUE foo 0 6
fooval
END
# replace bar (should work)
replace bar 0 0 6
barva2
STORED
get bar
VALUE bar 0 6
barva2
END
# replace notexist (shouldn't work)
replace notexist 0 0 6
barva2
NOT_STORED
get notexist
END
# delete foo
delete foo
DELETED
get foo
END
# delete foo again. not found this time.
delete foo
NOT_FOUND
get foo
END
# add moo
add moo 0 0 6
mooval
STORED
get moo
VALUE moo 0 6
mooval
END
# check-and-set (cas) failure case, try to set value with incorrect cas unique val
cas moo 0 0 6 0
MOOVAL
EXISTS
get moo
VALUE moo 0 6
mooval
END
# now test that we can store moo with the correct unique id
get moo
VALUE moo 0 6
MOOVAL
END
set foo 0 0 6
fooval
delete foo
set foo 0 0 6
fooval
delete foo
STORED
DELETED
STORED
DELETED
# set big data: - should pass
set foo_1024 0 0 1024
<big-data>

STORED

# set big data: - should pass
set foo_525312 0 0 525312
<big-data>

STORED

# Ensure causing a memory overflow doesn't leave stale data.
# set small data: - should pass
set foo_1049600 0 0 3
MOO
STORED
get foo_1049600
VALUE foo_1049600 0 3
MOO
END
# set big data: - should fail
set foo_1049600 0 0 1049600
<big-data>

SERVER_ERROR object too large for cache

#
# A test for Bug#898198 memcached protocol isn't case-insensitive"
#
SET foo 0 0 6
fooval
STORED
GET foo
VALUE foo 0 6
fooval
END
ADD foo 0 0 5
foov2
NOT_STORED
GET foo
VALUE foo 0 6
fooval
END
REPLACE bar 0 0 6
barva2
STORED
GET bar
VALUE bar 0 6
barva2
END
DELETE foo
DELETED
GET foo
END
CAS moo 0 0 6 0
MOOVAL
EXISTS
GET moo
VALUE moo 0 6
MOOVAL
END
GETS moo
VALUE moo 0 6 46
MOOVAL
END
