# encoding: tarantool

exec admin "lua type(box.digest)"

exec admin "lua box.digest.md4_hex()"
exec admin "lua box.digest.md5_hex()"
exec admin "lua box.digest.sha_hex()"
exec admin "lua box.digest.sha1_hex()"
exec admin "lua box.digest.sha224_hex()"
exec admin "lua box.digest.sha256_hex()"
exec admin "lua box.digest.sha384_hex()"
exec admin "lua box.digest.sha512_hex()"

exec admin "lua string.len(box.digest.md4_hex())"
exec admin "lua string.len(box.digest.md5_hex())"
exec admin "lua string.len(box.digest.sha_hex())"
exec admin "lua string.len(box.digest.sha1_hex())"
exec admin "lua string.len(box.digest.sha224_hex())"
exec admin "lua string.len(box.digest.sha256_hex())"
exec admin "lua string.len(box.digest.sha384_hex())"
exec admin "lua string.len(box.digest.sha512_hex())"

exec admin "lua string.len(box.digest.md4())"
exec admin "lua string.len(box.digest.md5())"
exec admin "lua string.len(box.digest.sha())"
exec admin "lua string.len(box.digest.sha1())"
exec admin "lua string.len(box.digest.sha224())"
exec admin "lua string.len(box.digest.sha256())"
exec admin "lua string.len(box.digest.sha384())"
exec admin "lua string.len(box.digest.sha512())"

exec admin "lua box.digest.md5_hex(123)"
exec admin "lua box.digest.md5_hex('123')"
exec admin "lua box.digest.md5_hex(true)"
exec admin "lua box.digest.md5_hex('true')"
exec admin "lua box.digest.md5_hex(nil)"
exec admin "lua box.digest.md5_hex()"

exec admin "lua box.digest.crc32()"
exec admin "lua box.digest.crc32_update(4294967295, '')"

exec admin "lua box.digest.crc32('abc')"
exec admin "lua box.digest.crc32_update(4294967295, 'abc')"

exec admin "lua box.digest.crc32('abccde')"
exec admin "lua box.digest.crc32_update(box.digest.crc32('abc'), 'cde')"
