
#
# iproto packages test
#


# Test bug #899343 (server assertion failure on incorrect packet)

# send the package with invalid length
12
# check that is server alive
ping
---
- ok
...

#  Test gh-206 "Segfault if sending IPROTO package without `KEY` field"

IPROTO_SELECT
query {'IPROTO_CODE': 1} {'IPROTO_SPACE_ID': 280}
ping
---
- ok
...


IPROTO_DELETE
query {'IPROTO_CODE': 5} {'IPROTO_SPACE_ID': 280}
ping
---
- ok
...


IPROTO_UPDATE
query {'IPROTO_CODE': 4} {'IPROTO_SPACE_ID': 280}
ping
---
- ok
...
query {'IPROTO_CODE': 4} {'IPROTO_SPACE_ID': 280, 'IPROTO_KEY': (1,)}
ping
---
- ok
...


IPROTO_REPLACE
query {'IPROTO_CODE': 3} {'IPROTO_SPACE_ID': 280}
ping
---
- ok
...


IPROTO_CALL
query {'IPROTO_CODE': 6} {}
ping
---
- ok
...
query {'IPROTO_CODE': 6} {'IPROTO_KEY': ('procname',)}
ping
---
- ok
...


box.cfg.wal_mode
---
- write
...
space = box.schema.create_space('test', { id = 567 })
---
...
space:create_index('primary', { type = 'hash' })
---
...
box.schema.user.grant('guest', 'read,write,execute', 'space', 'test')
---
...
---
- [1, 'baobab']
...
---
- [2, 'obbaba']
...
---
- [1, 'baobab']
...
---
- [3, 'occama']
...
---
- [2, 'obbaba']
...
---
- [4, 'ockham']
...
---
- [1, 'baobab']
...
---
- [2, 'obbaba']
...
space:drop()
---
...
